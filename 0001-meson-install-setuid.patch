From b4d4d3be6c880c098dc5629343f5d991ec13c3e1 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 1/6] meson: install chfn setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index af9add457..eebf9df8f 100644
--- a/meson.build
+++ b/meson.build
@@ -896,6 +896,7 @@ exe = executable(
   link_with : [lib_common, logindefs_c],
   dependencies : chfn_chsh_deps,
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 
-- 
2.41.0


From be72f2d2ba8c1fb93139ee338609ab4536eae80e Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 2/6] meson: install chsh setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index eebf9df8f..eae42f01a 100644
--- a/meson.build
+++ b/meson.build
@@ -909,6 +909,7 @@ exe2 = executable(
   link_with : lib_common,
   dependencies : chfn_chsh_deps,
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From 22e7e2f981dca350a30e3b70831c88a004d739bc Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 3/6] meson: install su setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index eae42f01a..6da9821c0 100644
--- a/meson.build
+++ b/meson.build
@@ -997,6 +997,7 @@ exe = executable(
                   lib_pam_misc,
                   lib_util,
                   realtime_libs],
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From c2ccf46fdfeba9848526cffd5a025d159c7fc1d6 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 4/6] meson: install newgrp setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index 6da9821c0..a28e3eb9b 100644
--- a/meson.build
+++ b/meson.build
@@ -1013,6 +1013,7 @@ exe = executable(
   include_directories : includes,
   dependencies : [lib_crypt],
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From eb0505714db5ab755270eb03227c32d026b72b79 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 5/6] meson: install mount setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index a28e3eb9b..e8231991a 100644
--- a/meson.build
+++ b/meson.build
@@ -1630,6 +1630,7 @@ exe = executable(
                lib_smartcols,
                lib_mount],
   dependencies : lib_selinux,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 exe2 = executable(
-- 
2.41.0


From c69e5ab38f7ef994148a0891e6c22a4181049293 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 6/6] meson: install umount setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index e8231991a..74c15b243 100644
--- a/meson.build
+++ b/meson.build
@@ -1639,6 +1639,7 @@ exe2 = executable(
   include_directories : includes,
   link_with : [lib_common,
                lib_mount],
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0

