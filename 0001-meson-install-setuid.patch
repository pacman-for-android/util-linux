From 60d457f52991e6f6472171035974ce7a3ae621f3 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 1/8] meson: install chfn setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index af9add457..eebf9df8f 100644
--- a/meson.build
+++ b/meson.build
@@ -896,6 +896,7 @@ exe = executable(
   link_with : [lib_common, logindefs_c],
   dependencies : chfn_chsh_deps,
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 
-- 
2.41.0


From a13574b1de21d7fd9a0ad63790a7452c369e46e5 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 2/8] meson: install chsh setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index eebf9df8f..eae42f01a 100644
--- a/meson.build
+++ b/meson.build
@@ -909,6 +909,7 @@ exe2 = executable(
   link_with : lib_common,
   dependencies : chfn_chsh_deps,
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From fb8c224eae4e28502e05770d35c8e3b8509a9b69 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 3/8] meson: install su setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index eae42f01a..6da9821c0 100644
--- a/meson.build
+++ b/meson.build
@@ -997,6 +997,7 @@ exe = executable(
                   lib_pam_misc,
                   lib_util,
                   realtime_libs],
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From cb3dee5a14da552a935680584d2fc5c37cb3a913 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 4/8] meson: install newgrp setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index 6da9821c0..a28e3eb9b 100644
--- a/meson.build
+++ b/meson.build
@@ -1013,6 +1013,7 @@ exe = executable(
   include_directories : includes,
   dependencies : [lib_crypt],
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From 8f49b3693d6f1db36d5ecb7328965686362deaa3 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 5/8] meson: install mount setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index a28e3eb9b..e8231991a 100644
--- a/meson.build
+++ b/meson.build
@@ -1630,6 +1630,7 @@ exe = executable(
                lib_smartcols,
                lib_mount],
   dependencies : lib_selinux,
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 exe2 = executable(
-- 
2.41.0


From 1cb3c90ca5de6ffb43f8a40605118a8d84a0c6f3 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 14:09:02 +0200
Subject: [PATCH 6/8] meson: install umount setuid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index e8231991a..74c15b243 100644
--- a/meson.build
+++ b/meson.build
@@ -1639,6 +1639,7 @@ exe2 = executable(
   include_directories : includes,
   link_with : [lib_common,
                lib_mount],
+  install_mode : 'rwsr-xr-x',
   install : opt,
   build_by_default : opt)
 if opt and not is_disabler(exe)
-- 
2.41.0


From 07641fd93c4829696c1e2101642fee32ad998025 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 15:02:57 +0200
Subject: [PATCH 7/8] meson: install wall setgid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index 74c15b243..8020f7d69 100644
--- a/meson.build
+++ b/meson.build
@@ -2390,6 +2390,7 @@ exe = executable(
   include_directories : includes,
   link_with : [lib_common],
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwxr-sr-x',
   install : opt,
   build_by_default : opt)
 if opt
-- 
2.41.0


From cee78467bea45f7a4f890f0c65bd59441bd42697 Mon Sep 17 00:00:00 2001
From: Christian Hesse <mail@eworm.de>
Date: Fri, 9 Jun 2023 15:04:00 +0200
Subject: [PATCH 8/8] meson: install write setgid

... as this requires elevated privileges.
---
 meson.build | 1 +
 1 file changed, 1 insertion(+)

diff --git a/meson.build b/meson.build
index 8020f7d69..2b59e2f01 100644
--- a/meson.build
+++ b/meson.build
@@ -2409,6 +2409,7 @@ exe = executable(
   include_directories : includes,
   link_with : [lib_common],
   install_dir : usrbin_exec_dir,
+  install_mode : 'rwxr-sr-x',
   install : opt,
   build_by_default : opt)
 if opt
-- 
2.41.0

